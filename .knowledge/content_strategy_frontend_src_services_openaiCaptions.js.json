{"is_source_file": true, "format": "JavaScript", "description": "This file provides a frontend-only service for generating captions using OpenAI's API, including functions for setting API keys, building prompts, normalizing results, and invoking the API to generate captions with different variations. It imports functions from an external 'openaiClient' module.", "external_files": ["./openaiClient"], "external_methods": ["callOpenAIChatCompletions", "extractModelText", "getEffectiveOpenAIKey", "getOpenAIKeySource", "mapOpenAIErrorToI18nKey", "normalizeLanguage", "parseStrictJsonFromModelText", "setOpenAIKeyForSession"], "published": ["setOpenAIKeyForSession", "getOpenAIKeySource", "getEffectiveOpenAIKey", "buildCaptionPrompt", "generateCaptions", "CaptionVariationType"], "classes": [], "methods": [{"name": "setOpenAIKeyForSession(apiKey)", "description": "Sets a temporary OpenAI API key in memory for the browser session.", "scope": "", "scopeKind": ""}, {"name": "getOpenAIKeySource()", "description": "Returns the source of the OpenAI key (env, memory, none).", "scope": "", "scopeKind": ""}, {"name": "getEffectiveOpenAIKey()", "description": "Returns the effective OpenAI API key, prioritizing environment over memory.", "scope": "", "scopeKind": ""}, {"name": "buildCaptionPrompt({ topic, niche, emotion, language })", "description": "Builds a prompt string for generating caption variations, considering language and cultural context.", "scope": "", "scopeKind": ""}, {"name": "generateCaptions({ topic, niche, emotion, language })", "description": "Calls OpenAI API to generate three caption variations based on provided parameters.", "scope": "", "scopeKind": ""}, {"name": "normalizeCaptionsResult({ raw, language, emotion })", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "normalizeVariationType(v)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "truncate(str, max)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["setOpenAIKeyForSession", "getOpenAIKeySource", "getEffectiveOpenAIKey", "callOpenAIChatCompletions", "extractModelText", "parseStrictJsonFromModelText", "mapOpenAIErrorToI18nKey"], "search-terms": ["openaiCaptions", "buildCaptionPrompt", "generateCaptions", "normalizeVariationType", "setOpenAIKeyForSession"], "state": 2, "file_id": 30, "knowledge_revision": 167, "git_revision": "99a0e67c42de75a9e1bf3e2c18131c85da8ee23b", "revision_history": [{"70": "99a0e67c42de75a9e1bf3e2c18131c85da8ee23b"}, {"167": "99a0e67c42de75a9e1bf3e2c18131c85da8ee23b"}], "ctags": [{"_type": "tag", "name": "CaptionVariationType", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^export const CaptionVariationType = VariationType;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildCaptionPrompt", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^export function buildCaptionPrompt({ topic, niche, emotion, language }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ topic, niche, emotion, language })"}, {"_type": "tag", "name": "generateCaptions", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^export async function generateCaptions({ topic, niche, emotion, language }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ topic, niche, emotion, language })"}, {"_type": "tag", "name": "getEffectiveOpenAIKey", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^export function getEffectiveOpenAIKey() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getOpenAIKeySource", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^export function getOpenAIKeySource() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "normalizeCaptionsResult", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^function normalizeCaptionsResult({ raw, language, emotion }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ raw, language, emotion })"}, {"_type": "tag", "name": "normalizeVariationType", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^function normalizeVariationType(v) {$/", "language": "JavaScript", "kind": "function", "signature": "(v)"}, {"_type": "tag", "name": "setOpenAIKeyForSession", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^export function setOpenAIKeyForSession(apiKey) {$/", "language": "JavaScript", "kind": "function", "signature": "(apiKey)"}, {"_type": "tag", "name": "truncate", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiCaptions.js", "pattern": "/^function truncate(str, max) {$/", "language": "JavaScript", "kind": "function", "signature": "(str, max)"}], "hash": "882babe35ff1577fbb6fe3fe58e795ff", "format-version": 4, "code-base-name": "content_strategy_frontend", "filename": "content_strategy_frontend/src/services/openaiCaptions.js"}