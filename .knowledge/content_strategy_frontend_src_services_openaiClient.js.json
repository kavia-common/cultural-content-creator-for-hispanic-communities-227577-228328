{"is_source_file": true, "format": "JavaScript", "description": "This file contains frontend helper functions and utilities for interacting with the OpenAI API, including setting and retrieving API keys, making chat completion requests, error handling, and response parsing. It is used specifically for browser environment interactions with OpenAI services.", "external_files": ["fetch"], "external_methods": ["fetch"], "published": ["setOpenAIKeyForSession", "getOpenAIKeySource", "getEffectiveOpenAIKey", "callOpenAIChatCompletions", "parseStrictJsonFromModelText", "extractModelText", "normalizeLanguage", "mapOpenAIErrorToI18nKey", "OpenAILanguage"], "classes": [], "methods": [{"name": "setOpenAIKeyForSession(apiKey)", "description": "Sets a temporary in-memory OpenAI API key for the current browser session.", "scope": "", "scopeKind": ""}, {"name": "getOpenAIKeySource()", "description": "Returns the source of the OpenAI API key (environment variable, in-memory, or none).", "scope": "", "scopeKind": ""}, {"name": "getEffectiveOpenAIKey()", "description": "Returns the effective OpenAI API key considering environment variable and in-memory key.", "scope": "", "scopeKind": ""}, {"name": "callOpenAIChatCompletions({ apiKey, system, prompt, temperature = 0.7, model = 'gpt-4o-mini' })", "description": "Makes a chat completion request to OpenAI API using fetch, handling errors and returning API response.", "scope": "", "scopeKind": ""}, {"name": "parseStrictJsonFromModelText(text)", "description": "Attempts to parse strictly formatted JSON from a string, with fallback to salvage JSON from malformed text.", "scope": "", "scopeKind": ""}, {"name": "extractModelText(payload)", "description": "Extracts assistant's reply text from a chat completion payload.", "scope": "", "scopeKind": ""}, {"name": "normalizeLanguage(lang)", "description": "Converts language input to a normalized 'en' or 'es' value.", "scope": "", "scopeKind": ""}, {"name": "mapOpenAIErrorToI18nKey(err)", "description": "Maps an error from OpenAI API or fetch to a user-friendly internationalization key.", "scope": "", "scopeKind": ""}, {"name": "extractTextFromChatCompletionPayload(payload)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "mapExceptionToKey(err)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "mapHttpErrorToKey(status)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "safeJsonParse(text)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["fetch", "JSON.parse", "JSON.stringify", "mapHttpErrorToKey", "mapExceptionToKey"], "search-terms": ["openaiClient", "chat/completions", "API key management", "error mapping", "chat payload extraction"], "state": 2, "file_id": 50, "knowledge_revision": 170, "git_revision": "ffa5604db6edb21c59cc94b775332d0207131f0a", "ctags": [{"_type": "tag", "name": "OpenAILanguage", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export const OpenAILanguage = Language;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "callOpenAIChatCompletions", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export async function callOpenAIChatCompletions({$/", "language": "JavaScript", "kind": "function", "signature": "({ apiKey, system, prompt, temperature = 0.7, model = 'gpt-4o-mini' })"}, {"_type": "tag", "name": "extractModelText", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export function extractModelText(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "extractTextFromChatCompletionPayload", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^function extractTextFromChatCompletionPayload(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "getEffectiveOpenAIKey", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export function getEffectiveOpenAIKey() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getOpenAIKeySource", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export function getOpenAIKeySource() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "inMemoryOpenAIKey", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^let inMemoryOpenAIKey = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "mapExceptionToKey", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^function mapExceptionToKey(err) {$/", "language": "JavaScript", "kind": "function", "signature": "(err)"}, {"_type": "tag", "name": "mapHttpErrorToKey", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^function mapHttpErrorToKey(status) {$/", "language": "JavaScript", "kind": "function", "signature": "(status)"}, {"_type": "tag", "name": "mapOpenAIErrorToI18nKey", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export function mapOpenAIErrorToI18nKey(err) {$/", "language": "JavaScript", "kind": "function", "signature": "(err)"}, {"_type": "tag", "name": "normalizeLanguage", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export function normalizeLanguage(lang) {$/", "language": "JavaScript", "kind": "function", "signature": "(lang)"}, {"_type": "tag", "name": "parseStrictJsonFromModelText", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export function parseStrictJsonFromModelText(text) {$/", "language": "JavaScript", "kind": "function", "signature": "(text)"}, {"_type": "tag", "name": "safeJsonParse", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^function safeJsonParse(text) {$/", "language": "JavaScript", "kind": "function", "signature": "(text)"}, {"_type": "tag", "name": "setOpenAIKeyForSession", "path": "/home/kavia/workspace/code-generation/cultural-content-creator-for-hispanic-communities-227577-228328/content_strategy_frontend/src/services/openaiClient.js", "pattern": "/^export function setOpenAIKeyForSession(apiKey) {$/", "language": "JavaScript", "kind": "function", "signature": "(apiKey)"}], "hash": "8f4a8ab0e3651da011de5b5516e797d2", "format-version": 4, "code-base-name": "content_strategy_frontend", "filename": "content_strategy_frontend/src/services/openaiClient.js", "fields": [{"name": "let inMemoryOpenAIKey = '';", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"170": "ffa5604db6edb21c59cc94b775332d0207131f0a"}]}